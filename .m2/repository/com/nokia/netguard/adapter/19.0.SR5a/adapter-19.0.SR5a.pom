<project xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<groupId>com.nokia.netguard</groupId>
	<artifactId>adapter</artifactId>
	<version>19.0.SR5a</version>
	<name>Nokia NetGuard Adapter</name>
	<packaging>pom</packaging>
	<properties>
		<maven.build.timestamp.format>yyyyMMdd.HHmmss</maven.build.timestamp.format>
		<adapter-type></adapter-type>
		<nak-file>${project.artifactId}-${project.version}</nak-file>
		<sonar.cobertura.reportPath>${project.basedir}/target/site/cobertura/coverage.xml</sonar.cobertura.reportPath>
		<sonar.core.codeCoveragePlugin>cobertura</sonar.core.codeCoveragePlugin>
		<sonar.java.coveragePlugin>cobertura</sonar.java.coveragePlugin>
		<sonar.junit.reportsPath>${project.basedir}/target/surefire-reports</sonar.junit.reportsPath>
		<sonar.surefire.reportsPath>${project.basedir}/target/surefire-reports</sonar.surefire.reportsPath>
		<customer>${project.version}</customer>
		<testSuite>OfflineSuite</testSuite>
		<adapterDefinitionDir>.</adapterDefinitionDir>
		<adt-dependencies-version>19.0.SR5a</adt-dependencies-version>
		<archetypePostPhase>install</archetypePostPhase>
	</properties>

	<modules>
		<module>../archetype/adapter-cli-template</module>
		<module>../archetype/adapter-adaptermanaged-template</module>
		<module>../archetype/adapter-guisso-template</module>
	</modules>

	<profiles>
		<profile>
			<id>default</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
		</profile>
		
		<profile>
			<id>adt-workspace-build</id>
			<activation>
				<property>
					<name>adt-workspace-build</name>
				</property>
			</activation>
			<properties>
				<archetype.properties>archetype.properties</archetype.properties>
				<skipTests>true</skipTests>
			</properties>
			<build>
				<pluginManagement>
					<plugins>
						<plugin>
							<groupId>org.apache.maven.plugins</groupId>
							<artifactId>maven-resources-plugin</artifactId>
							<configuration>
								<resources>
									<resource>
										<directory>src/test/resources/projects/</directory>
										<targetPath>${project.basedir}/target/generated-sources/archetype/${project.version}/src/test/resources/projects/</targetPath>
										<filtering>true</filtering>
									</resource>
								</resources>
							</configuration>
						</plugin>
						<plugin>
							<groupId>org.apache.maven.plugins</groupId>
							<artifactId>maven-archetype-plugin</artifactId>
							<executions>
								<execution>
									<id>archetype-create-from-project</id>
									<phase>install</phase>
									<goals>
										<goal>create-from-project</goal>
									</goals>
									<configuration>
										<archetypePostPhase>${archetypePostPhase}</archetypePostPhase>
										<outputDirectory>${project.build.directory}/generated-sources/archetype/${project.version}/</outputDirectory>
									</configuration>
								</execution>
							</executions>
						</plugin>
					</plugins>
				</pluginManagement>
			</build>
		</profile>

		<profile>
			<id>adapter-build</id>
			<activation>
				<property>
					<name>!adt-workspace-build</name>
				</property>
			</activation>
			<build>
				<pluginManagement>
					<plugins>
						<plugin>
							<groupId>org.apache.maven.plugins</groupId>
							<artifactId>maven-resources-plugin</artifactId>
							<configuration>
								<resources>
									<resource>
										<directory>src/main/resources</directory>
										<excludes>
											<exclude>**/*</exclude>
										</excludes>
									</resource>
									<resource>
										<directory>src/main/resources/${adapterDefinitionDir}/</directory>
										<filtering>true</filtering>
										<includes>
											<include>*</include>
										</includes>
									</resource>
									<resource>
										<directory>src/main/resources/${adapterDefinitionDir}/scripts/</directory>
									</resource>
								</resources>
							</configuration>
						</plugin>
						<plugin>
							<groupId>org.apache.maven.plugins</groupId>
							<artifactId>maven-surefire-plugin</artifactId>
							<configuration>
								<includes>
									<include>**/${testSuite}.class</include>
								</includes>
							</configuration>
						</plugin>
						<plugin>
							<groupId>org.apache.maven.plugins</groupId>
							<artifactId>maven-assembly-plugin</artifactId>
							<configuration>
								<descriptors>
									<descriptor>fat-jar.xml</descriptor>
								</descriptors>
							</configuration>
							<executions>
								<execution>
									<id>fat-jar</id>
									<phase>package</phase>
									<goals>
										<goal>single</goal>
									</goals>
								</execution>
							</executions>
						</plugin>
						<plugin>
							<groupId>org.apache.maven.plugins</groupId>
							<artifactId>maven-antrun-plugin</artifactId>
							<executions>
								<execution>
									<id>nak-file</id>
									<phase>package</phase>
									<goals>
										<goal>run</goal>
									</goals>
									<configuration>
										<target>
											<move
												file="${basedir}/target/${adapterDefinitionDir}/${project.artifactId}-${project.version}-fat-jar.jar"
												toFile="${basedir}/target/${adapterDefinitionDir}/${nak-file}.nak" />
										</target>
									</configuration>
								</execution>
							</executions>
						</plugin>
						<plugin>
							<groupId>org.codehaus.mojo</groupId>
							<artifactId>sonar-maven-plugin</artifactId>
							<configuration>
								<argLine>-Djavax.net.ssl.trustStore=sonar.jks</argLine>
							</configuration>
						</plugin>
						<plugin>
							<groupId>org.codehaus.mojo</groupId>
							<artifactId>cobertura-maven-plugin</artifactId>
							<configuration>
								<formats>
									<format>html</format>
									<format>xml</format>
								</formats>
							</configuration>
						</plugin>
						<plugin>
							<groupId>org.apache.maven.plugins</groupId>
							<artifactId>maven-dependency-plugin</artifactId>
							<executions>
								<execution>
									<id>get-nak-validator</id>
									<phase>package</phase>
									<goals>
										<goal>copy-dependencies</goal>
									</goals>
									<configuration>
										<excludeArtifactIds>*</excludeArtifactIds>
										<includeArtifactIds>adapter-validator</includeArtifactIds>
										<stripVersion>true</stripVersion>
										<stripClassifier>true</stripClassifier>
										<outputDirectory>${project.build.directory}/</outputDirectory>
									</configuration>
								</execution>
							</executions>
						</plugin>
						<plugin>
							<groupId>org.codehaus.mojo</groupId>
							<artifactId>exec-maven-plugin</artifactId>
							<executions>
								<execution>
									<id>validate-nak</id>
									<goals>
										<goal>exec</goal>
									</goals>
									<phase>package</phase>
									<configuration>
										<executable>java</executable>
										<workingDirectory>${project.build.directory}/</workingDirectory>
										<arguments>
											<argument>-jar</argument>
											<argument>adapter-validator.jar</argument>
											<argument>${nak-file}.nak</argument>
											<argument>${nak-file}.validator-report.html</argument>
											<argument>INFO</argument>
										</arguments>
									</configuration>
								</execution>
							</executions>
						</plugin>
						<plugin>
							<groupId>org.apache.maven.plugins</groupId>
							<artifactId>maven-install-plugin</artifactId>
							<executions>
								<execution>
									<id>default-install</id>
									<phase>none</phase>
								</execution>
							</executions>
						</plugin>
						<plugin>
							<groupId>org.apache.maven.plugins</groupId>
							<artifactId>maven-deploy-plugin</artifactId>
							<executions>
								<execution>
									<id>default-deploy</id>
									<phase>none</phase>
								</execution> 
							</executions>
						</plugin>
					</plugins>
				</pluginManagement>
			</build>
		</profile>

		<profile>
			<id>deploy-snapshot</id>
			<activation>
				<property>
					<name>deploy-snapshot</name>
				</property>
			</activation>
			<properties>
				<archetypePostPhase>deploy</archetypePostPhase>
				<distributionManagementUrl>https://repo.lab.pl.alcatel-lucent.com/security-mvn-snapshots</distributionManagementUrl>
			</properties>
			<distributionManagement>
				<repository>
					<id>epsec-mvn</id>
					<name>epsec-mvn</name>
					<url>https://repo.lab.pl.alcatel-lucent.com/security-mvn-snapshots</url>
				</repository>
			</distributionManagement>
		</profile>
		
		<profile>
			<id>deploy-release</id>
			<activation>
				<property>
					<name>deploy-release</name>
				</property>
			</activation>
			<properties>
				<archetypePostPhase>deploy</archetypePostPhase>
				<distributionManagementUrl>https://repo.lab.pl.alcatel-lucent.com/security-mvn-releases</distributionManagementUrl>
			</properties>
			<distributionManagement>
				<repository>
					<id>epsec-mvn</id>
					<name>epsec-mvn</name>
					<url>https://repo.lab.pl.alcatel-lucent.com/security-mvn-releases</url>
				</repository>
			</distributionManagement>
		</profile>
	</profiles>

	<build>
		<plugins>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-compiler-plugin</artifactId>
				<configuration>
					<source>1.8</source>
					<target>1.8</target>
				</configuration>
			</plugin>
		</plugins>

		<pluginManagement>
			<plugins>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-compiler-plugin</artifactId>
					<version>3.8.0</version>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-archetype-plugin</artifactId>
					<version>3.0.1</version>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-resources-plugin</artifactId>
					<version>3.1.0</version>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-jar-plugin</artifactId>
					<version>3.1.0</version>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-surefire-plugin</artifactId>
					<version>2.22.1</version>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-assembly-plugin</artifactId>
					<version>3.1.0</version>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-antrun-plugin</artifactId>
					<version>1.8</version>
				</plugin>
				<plugin>
					<groupId>org.codehaus.mojo</groupId>
					<artifactId>sonar-maven-plugin</artifactId>
					<version>3.5.0.1254</version>
				</plugin>
				<plugin>
					<groupId>org.codehaus.mojo</groupId>
					<artifactId>cobertura-maven-plugin</artifactId>
					<version>2.7</version>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-install-plugin</artifactId>
					<version>3.0.0-M1</version>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-deploy-plugin</artifactId>
					<version>3.0.0-M1</version>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-dependency-plugin</artifactId>
					<version>3.1.1</version>
				</plugin>
				<plugin>
					<groupId>org.codehaus.mojo</groupId>
					<artifactId>exec-maven-plugin</artifactId>
					<version>1.6.0</version>
				</plugin>
			</plugins>
		</pluginManagement>
	</build>

	<dependencies>
		<!-- scope test -->
		<dependency>
			<groupId>com.btmatthews.junit</groupId>
			<artifactId>junit-rules</artifactId>
			<version>1.0.1</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.googlecode.junit-toolbox</groupId>
			<artifactId>junit-toolbox</artifactId>
			<version>2.4</version>
			<scope>test</scope>
			<exclusions>
				<exclusion>
					<groupId>org.mockito</groupId>
					<artifactId>mockito-core</artifactId>
				</exclusion>
			</exclusions>
		</dependency>
		<dependency>
			<groupId>org.powermock</groupId>
			<artifactId>powermock-api-mockito</artifactId>
			<version>1.7.3</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.powermock</groupId>
			<artifactId>powermock-module-junit4</artifactId>
			<version>1.7.3</version>
			<scope>test</scope>
		</dependency>
		<!-- scope compile -->

		<!-- scope provided -->
		<dependency>
			<groupId>commons-configuration</groupId>
			<artifactId>commons-configuration</artifactId>
			<version>1.6</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.logging.log4j</groupId>
			<artifactId>log4j-api</artifactId>
			<version>2.10.0</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.logging.log4j</groupId>
			<artifactId>log4j-core</artifactId>
			<version>2.10.0</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.commons</groupId>
			<artifactId>commons-csv</artifactId>
			<version>1.5</version>
		</dependency>
		<dependency>
		    <groupId>epsec.products.framework</groupId>
		    <artifactId>publishedInterfaceExtensions</artifactId>
		    <version>19.0.20</version>
		</dependency>
		<dependency>
		    <groupId>epsec.products.framework</groupId>
		    <artifactId>publishedInterfaces</artifactId>
		    <version>19.0.8</version>
		    <scope>provided</scope>
		</dependency>		
		<dependency>
		    <groupId>epsec.products.framework</groupId>
		    <artifactId>publishedTypes</artifactId>
		    <version>19.0.9</version>
		    <scope>provided</scope>
		</dependency>
		<dependency>
		    <groupId>epsec.products.framework.appbase</groupId>
		    <artifactId>appbase-shared</artifactId>
		    <version>19.0.10</version>
		    <scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.nokia.netguard.adt</groupId>
			<artifactId>adapter-validator</artifactId>
			<version>1.0.4</version>
			<scope>provided</scope>
		</dependency>
		<!-- END of DO NOT MODIFY! -->
	</dependencies>

</project>